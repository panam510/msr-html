<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<style type="text/css">
		html,
		body {
			height: 100%;
			margin: 0px;
		}

		textarea {
			width: 99vw;
			height: 45vh;
		}

		input {
			width: 99.5vw;
			height: 5vh;
			min-height: 2em;
		}
	</style>
	<script>
		function parseHTML() {
			document.getElementById("result").value="\tåˆ©ç”¨é‡‘é¡\t\tåˆè¨ˆ\t=SUM(E2:E26)*1.1\n\tè¬ç¤¼é‡‘é¡\t\n\tå…¥åº—æ™‚åˆ»\t\n\tç€å¸­æ™‚åˆ»\t\n\té€€åº—æ™‚åˆ»\t\n\tä¼šè¨ˆé‡‘é¡\t\n\tã‚¯ãƒ¼ãƒãƒ³åˆ©ç”¨é¡\t\n\tåº§å¸­ä½ç½®\t\n\tæ··é›‘çŠ¶æ³\t\n"
			var parser = new DOMParser();
			var doc = parser.parseFromString(document.getElementById("source").value, "text/html");
			var q1h1h2 = doc.querySelectorAll(".q1tb1, .h1td2, .h2td1, .h1td3"); // æ¬²ã—ã„è¦ç´ ã®ã‚¯ãƒ©ã‚¹ã€‚q1ãŒè³ªå•äº‹é …ã€h1/h2ãŒå°è¦‹å‡ºã—
			for (var i = 0; i < q1h1h2.length; i++) { // å–å¾—ã—ãŸã‚¯ãƒ©ã‚¹ã‚’ä¸Šã‹ã‚‰é †ã«å‡¦ç†
				if (q1h1h2[i].className.indexOf("q1tb1") != -1) { // è³ªå•äº‹é …ã®ã‚¯ãƒ©ã‚¹ã ã£ãŸå ´åˆã«è¡Œã†å‡¦ç†
					var q1td1 = q1h1h2[i].getElementsByClassName('q1td1'); // tdã‚»ãƒ«ã®å†…å®¹ã‚’ä¸€æ‹¬ã§å–å¾—
					// è³ªå•ã‚¿ã‚¤ãƒ—ã€‚è³ªå•ãƒ†ãƒ¼ãƒ–ãƒ«å†…ã«è©²å½“ã™ã‚‹è¦ç´ ãŒã‚ã‚‹ã‹ã©ã†ã‹ã§åˆ¤å®š
					var hasIframe = q1h1h2[i].querySelector("iframe") != null; // ãŠå†™çœŸæ·»ä»˜ç”¨ã®iframe
					var hasTextArea = (q1h1h2[i].querySelector("textarea") != null && q1h1h2[i].querySelector("textarea").rows > 1); // textareaã§æ›¸ã‹ã›ã‚‹é•·ã„ãƒ†ã‚­ã‚¹ãƒˆ
					var hasTextBox = (q1h1h2[i].querySelector("input[type='text']") != null || (q1h1h2[i].querySelector("textarea") != null && q1h1h2[i].querySelector("textarea").rows == 1)); // input type=textã‹ã€row1ã®textareaã§æ›¸ã‹ã›ã‚‹çŸ­ã„ãƒ†ã‚­ã‚¹ãƒˆ
					for (var j = 0; j < q1td1.length; j++) { // tdã‚»ãƒ«ã‚’ä¸Šã‹ã‚‰é †ç•ªã«å‡¦ç†
						if (RegExp(/^Q\d+\.$/).test(q1td1[j].textContent)) { // è³ªå•ç•ªå·ï¼ˆQ1.ãªã©ï¼‰ã®ã‚»ãƒ«
							switch (true) {
								case hasIframe: // ãŠå†™çœŸ
									document.getElementById("result").value += q1td1[j].textContent + "ğŸ“·\t";
									break;
								case hasTextArea: // é•·ãƒ†ã‚­ã‚¹ãƒˆ
									document.getElementById("result").value += q1td1[j].textContent + "ğŸ“\t";
									break;
								case hasTextBox: // çŸ­ãƒ†ã‚­ã‚¹ãƒˆ
									document.getElementById("result").value += q1td1[j].textContent + "ğŸ–Šï¸\t";
									break;
								default: // ãã‚Œä»¥å¤–ï¼ˆãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ãªã©ï¼‰
									document.getElementById("result").value += q1td1[j].textContent + "ï¸\t";
									break;
							}
						} else if (q1td1[j].textContent.trim() == "") { // ç©ºæ¬„ã®ã‚»ãƒ«ã€‚ã‚¿ãƒ–ã ã‘å…¥ã‚Œã‚‹
							document.getElementById("result").value += "ï¸\t";
						} else { // è³ªå•å†…å®¹ã®æœ¬ä½“ãŒå…¥ã£ã¦ã„ã‚‹ã‚»ãƒ«ã€‚ã¾ãšæœ«å°¾ã«ç©ºè¡ŒãŒã‚ã‚Œã°é™¤å»ã€é€”ä¸­ã®æ”¹è¡Œã«ã¯ã‚¿ãƒ–ã‚’æŒ¿å…¥ã™ã‚‹
							document.getElementById("result").value += q1td1[j].innerText.replace(/\n$/g, '').replace(/^\n/gm, '').replace(/\n/g, "\n\t") + "\n";
						}
					}
				} else if (q1h1h2[i].className.indexOf("h1td3") != -1) { // å°è¦‹å‡ºã—ä¸‹ã®å‚™è€ƒã€‚å°è¦‹å‡ºã—ã®å³ã«å‡ºã—ãŸã„
					document.getElementById("result").value = document.getElementById("result").value.replace(/\n$/g, "\t\t") + q1h1h2[i].textContent + "\n";
				} else { // è³ªå•ã§ã¯ãªã„ã‚»ãƒ«ï¼å°è¦‹å‡ºã—ã€‚ãã®ã¾ã¾å†…å®¹ã‚’å…¥ã‚Œã¦æ”¹è¡Œ
					document.getElementById("result").value += q1h1h2[i].textContent + "\n";
				}
			}
		}
	</script>
</head>

<body>
	<textarea id="source">
</textarea>
	<br />
	<input type="button" onclick="parseHTML();" value="spread">
	<br />
	<textarea id="result">
	åˆ©ç”¨é‡‘é¡		åˆè¨ˆ	=SUM(E2:E26)*1.1
	è¬ç¤¼é‡‘é¡	
	å…¥åº—æ™‚åˆ»	
	ç€å¸­æ™‚åˆ»	
	é€€åº—æ™‚åˆ»	
	ä¼šè¨ˆé‡‘é¡	
	ã‚¯ãƒ¼ãƒãƒ³åˆ©ç”¨é¡	
	åº§å¸­ä½ç½®	
	æ··é›‘çŠ¶æ³	
</textarea>
</body>

</html>
